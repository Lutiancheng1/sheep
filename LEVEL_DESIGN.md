# 关卡设计文档 (Level Design Document)

本文档详细阐述了本项目的关卡设计理念，基于《羊了个羊》的游戏机制分析与博弈论模型。

## 核心设计哲学

游戏的核心体验建立在 **“新手 -> 策略 -> 运气”** 的三阶段难度曲线上。

### 1. 机制：披着智力皮的概率游戏
*   **理论可解性**：我们的生成算法采用“逆向生成法”，保证了每一关在理论上都存在至少一种解法（绝对死局被排除）。
*   **实际体验**：虽然理论有解，但由于**层数堆叠**和**遮蔽机制**，玩家无法获得完全信息。
    *   **前期**：信息暴露多，依靠策略（计算消除顺序）取胜。
    *   **后期**：信息暴露少，依靠运气（赌被遮蔽的牌正是需要的牌）取胜。

## 难度曲线规划 (Level 1-10)

我们将 10 个关卡划分为三个明显的阶段：

### Phase 1: 新手村 (Tutorial)
旨在让玩家熟悉操作，建立自信。

*   **Level 1**
    *   **定位**：绝对必胜。
    *   **配置**：21 张牌，2 层。
    *   **布局**：`Staggered` (简单错位)。
    *   **特征**：牌量极少，几乎没有遮蔽，闭眼也能过。

### Phase 2: 策略期 (Strategy)
难度陡增，玩家需要开始动脑，利用“备选槽”进行缓存和挖掘。

*   **Level 2**
    *   **定位**：难度突变点（劝退第一波）。
    *   **配置**：54 张牌，4 层。
    *   **布局**：`Brick` (砌墙模式)。
    *   **特征**：层数加倍，出现明显的遮蔽关系。玩家必须优先消除“压在上面”的牌。
*   **Level 3 - 5**
    *   **定位**：进阶挑战。
    *   **配置**：72 - 108 张牌，5 - 7 层。
    *   **布局**：
        *   L3: `Pyramid` (金字塔) - 考验对中心堆叠的处理。
        *   L4: `Spiral` (螺旋) - 考验对长条形依赖的处理。
        *   L5: `Cross` (十字/X型) - 考验对多端点的处理。

### Phase 3: 地狱/运气期 (Hell / Luck)
模拟原版“通关率不到 0.1%”的绝望体验。

*   **Level 6 - 10**
    *   **定位**：极限挑战，运气主导。
    *   **配置**：135 - 240+ 张牌，8 - 12 层。
    *   **布局**：
        *   L6: 高密度错位。
        *   L7: 双金字塔。
        *   L8: 大螺旋。
        *   L9: 随机高密度散布。
        *   L10: **"The Boss"** - 中央超高堆叠 + 周围散布。
    *   **特征**：
        *   **极深层数**：10层以上的堆叠意味着你完全无法预测底部的牌。
        *   **信息黑洞**：90% 的牌被遮蔽，玩家的每一步选择都在“赌博”。
        *   **容错率极低**：备选槽一旦被无法消除的牌占满，几乎必死。

## 技术实现细节

### 1. 逆向生成算法 (Solvability)
为了保证“理论有解”，我们不使用随机堆叠，而是：
1.  确定所有牌的位置和层级。
2.  计算当前的“可消除集合”（即未被遮蔽的牌）。
3.  从集合中随机选 3 个赋予相同图案。
4.  模拟消除，更新集合。
5.  重复直至所有牌分配完毕。

### 2. 布局模式 (Patterns)
*   **Staggered**: 标准错位，类似砖墙，最稳健的结构。
*   **Pyramid**: 中心高四周低，迫使玩家向中心挖掘。
*   **Spiral**: 螺旋状延伸，依赖链极长，容易卡死。
*   **Boss**: 模拟原版最终关，中间一个深不见底的坑，周围只有少量散牌用于缓存。

---
*Created by Antigravity Agent based on Game Theory Analysis*
